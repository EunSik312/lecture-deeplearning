# 원동식 교수님 강의 dongshikw@gmail.com

자율주행을 위한 데이터 처리 - 원동식Dr

칼만필터와 데이터 추적 기법

라이다, 레이더 데이터 처리 carla 시뮬레이터

경로계획 알고리즘

pid제어 기법 및 응용

쿠다 자율주행 시스템 설계 및 구현

## 8월4일

칼만 필터란 무엇인가

센서 융합과 칼만 필터

칼만 필터 실습과 한계

칼만 필터는 다양한 센서 데이터를 결합해서 차량의 위치와 속도를 정확하게 추정하는 데 필수적인 도구

#### 학습목표

1. 칼만 필터의 기본 개념과 동작 원리이해
2. 센서 데이터에 포함된 노이즈의 원인과 문제점을 파악
3. 자율주행에서 칼만 필터가 왜 필수적인지, 실제 적용 사례와 연결해 설명
4. 실습을 통해 칼만 필터의 예측과 갱신 과정을 직접 구현

#### Ch.1 센서 데이터의 노이즈란?
센서 데이터는 전자적 잡음, 환경 변화, 하드웨어 한계 등으로 항상 오차를 포함함

노이즈: True value 과 measured value의 차이

자율주행에서 노이즈가 누적되면 위치 추정이 크게 어긋나 안전에 치명적일 수 있음

GPS공부

칼만필터는 "노이즈 섞인 측정값들을 지능적으로 결합해 최적의 추정치를 계산하는 알고리즘
>> 계속해서 예측하고, 실제 측정값과 비교해 조정하는 과정

단순한 산술 평균과 달리, 각 측정값의 신뢰도(불확실성)을 고려하여 가중 평균을 계산한다

신뢰도가 높은 측정값에는 높은 가중치를, 낮은 측정값에는 낮은 가중치를 부여한다

<img width="588" height="353" alt="image" src="https://github.com/user-attachments/assets/e6f29184-5b35-42d9-a5bb-da83b2d447e3" />

평균만 취하는 것이 아니라 측정치를 얼마나 신뢰할 수 있는지 학습시키는 것

칼만 필터는 예측과 갱신을 무한히 반복한다

예측 상태: 이전 상태를 바탕으로 현재 상태를 추축

갱신 단계: 실제 센서 측정값으로 예측값을 보정함
>> 시간이 지날수록 정확한 값으로 다가감

<img width="1033" height="697" alt="image" src="https://github.com/user-attachments/assets/a69a361b-ecec-4f59-9b0d-b99bbec1eafd" />

물류창고의 이동로봇등에 사용
관절 개수가 늘어날 수록 정확한 위치를 알기 어려움

칼만 필터는 노이즈가 많은 센서 데이터를 결합하여 실시간으로 최적의 상태를 추정하는 핵심 알고리즘

동작 원리는 예측과 갱신의 끊임없는 반복

핵심 아이디어는 각 데이터의 불확실성(신뢰도)을 고려한 지능적인 가중 평균

응용 분야는 정밀한 실시간 추정이 필요한 모든 시스템(드론,자율주행,로봇등)

<img width="1059" height="743" alt="image" src="https://github.com/user-attachments/assets/b48bc9e0-3988-4558-8190-d9cc8131afaa" />

#### Ch.2 센서 융합과 칼만 필터
센서 융합을 통해 각기 다른 센서의 장점을 취하고 단점을 보완함, 더 정화갛고 신뢰성이 높은 인지 결과를 만들어냄

왜 센서를 여러개 사용해야 하는가?
<img width="1036" height="250" alt="image" src="https://github.com/user-attachments/assets/a81004a4-9783-41fc-9eec-aad8c73f0d6c" />
<img width="1024" height="624" alt="image" src="https://github.com/user-attachments/assets/f084932d-f11e-4ab8-b586-963ea736d268" />

칼만 필터 실습 결과

<img width="1176" height="532" alt="image" src="https://github.com/user-attachments/assets/0b5ec6bb-1673-4efc-a139-a275d8d093b3" />

센서 융합 실급 결과 
<img width="699" height="455" alt="image" src="https://github.com/user-attachments/assets/3e356f54-05b9-4a80-bc87-80cf0063867b" />
<img width="216" height="59" alt="image" src="https://github.com/user-attachments/assets/4bb1d513-a98e-4fe7-98f6-cb811fd99c29" />
<img width="184" height="54" alt="image" src="https://github.com/user-attachments/assets/e0e8db6c-b08e-4f86-b33b-00dd8515e459" />
<img width="205" height="78" alt="image" src="https://github.com/user-attachments/assets/24e1f621-39e0-4e1e-8626-885e555c7abb" />

숫자는 어떻게, 언제, 왜 구해야 하는지?
<img width="550" height="430" alt="image" src="https://github.com/user-attachments/assets/95ff0863-bbc7-4eec-9ed7-20da4fe25d13" />


선형 정적 시스템, 가우시안 분포, 선형 칼만 필터

<img width="1033" height="272" alt="image" src="https://github.com/user-attachments/assets/e515b1e3-57df-4048-a17c-2151b5e4fc4e" />


<img width="1018" height="386" alt="image" src="https://github.com/user-attachments/assets/fa361a3c-6280-4bc3-b107-76e22405e82b" />

| 단계  | 코드                     | 설명                                      |
| --- | ---------------------- | --------------------------------------- |
| 1️⃣ | `kalman_gain = ...`    | 측정값과 기존 추정값 중 어느 쪽을 더 신뢰할지 결정하는 **가중치** |
| 2️⃣ | `estimate = ...`       | **측정값과 추정값의 차이**를 반영하여 추정치를 업데이트        |
| 3️⃣ | `estimate_error = ...` | 업데이트 후 불확실성이 얼마나 줄었는지를 반영하여 **오차 감소**   |
<img width="952" height="251" alt="image" src="https://github.com/user-attachments/assets/b40cf8e4-bc65-4d39-88a7-c986c451b020" />

<img width="960" height="271" alt="image" src="https://github.com/user-attachments/assets/d5da809c-34d4-465e-9e3a-a82c89ddedb6" />



